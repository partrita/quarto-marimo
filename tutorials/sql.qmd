---
title: Sql
marimo-version: 0.13.2
width: medium
lang: ko
---

# ì•ˆë…•í•˜ì„¸ìš”, SQL!

_í…Œì´ë¸”ì„ ë‹¤ë£¨ëŠ” ê²ƒë¿ë§Œ ì•„ë‹ˆë¼ ì¡°ì¸ë„ í•˜ëŠ” SQLì˜ ì„¸ê³„ë¡œ ë›°ì–´ë“¤ì–´ ë´…ì‹œë‹¤!_
<!---->
marimoë¥¼ ì‚¬ìš©í•˜ë©´ **Pythonê³¼ SQL**ì„ í˜¼í•©í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. SQL ì…€ì„ ë§Œë“¤ë ¤ë©´ ë¨¼ì € [duckdb](https://duckdb.org/)ë¥¼ í¬í•¨í•œ ëª‡ ê°€ì§€ ì¶”ê°€ ì¢…ì†ì„±ì„ ì„¤ì¹˜í•´ì•¼ í•©ë‹ˆë‹¤. ë‹¤ìŒì„ ì‚¬ìš©í•˜ì—¬ ì´ëŸ¬í•œ ì¢…ì†ì„±ì„ ì–»ìŠµë‹ˆë‹¤.

```bash
pip install 'marimo[sql]'
```

```python {.marimo hide_code="true"}
has_duckdb_installed = False
try:
    import duckdb

    has_duckdb_installed = True
except ImportError:
    pass

has_polars_installed = False
try:
    import polars

    has_polars_installed = True
except ImportError:
    pass

has_pandas_installed = False
try:
    import pandas

    has_pandas_installed = True
except ImportError:
    pass
```

```python {.marimo hide_code="true"}
if has_duckdb_installed:
    mo.output.replace(
        mo.md(
            """
            /// íŒ | "ì„¤ì¹˜ë¨"

                ì´ê²ƒì´ ë³´ì´ë©´ DuckDBê°€ ì´ë¯¸ ì„¤ì¹˜ëœ ê²ƒì…ë‹ˆë‹¤.
            ///
            """
        )
    )
else:
    mo.output.replace(
        mo.md(
            """
            /// ê²½ê³  | "ì„¤ì¹˜ë˜ì§€ ì•ŠìŒ"
                ì´ê²ƒì´ ë³´ì´ë©´ DuckDBê°€ ì„¤ì¹˜ë˜ì§€ ì•Šì€ ê²ƒì…ë‹ˆë‹¤.
            ///
            """
        )
    )
```

## SQL ì…€ ë§Œë“¤ê¸°

í•„ìš”í•œ ì¢…ì†ì„±ì´ ì„¤ì¹˜ë˜ë©´ ë‹¤ìŒ ë°©ë²• ì¤‘ í•˜ë‚˜ë¡œ SQL ì…€ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- ì…€ ì™¼ìª½ì˜ **ì…€ ì¶”ê°€** ::lucide:circle-plus:: ë²„íŠ¼ì„ ë§ˆìš°ìŠ¤ ì˜¤ë¥¸ìª½ ë²„íŠ¼ìœ¼ë¡œ í´ë¦­í•©ë‹ˆë‹¤.
- ì…€ ë©”ë‰´ ::lucide:ellipsis::ì—ì„œ **SQLë¡œ ë³€í™˜** ::lucide:database:: ë²„íŠ¼ì„ í´ë¦­í•©ë‹ˆë‹¤.
- í˜ì´ì§€ í•˜ë‹¨ì˜ **SQL ì…€ ì¶”ê°€**ë¥¼ í´ë¦­í•©ë‹ˆë‹¤.

## Python í‘œí˜„
marimoëŠ” SQLì„ ì‚¬ìš©í•  ë•Œë„ ì—¬ì „íˆ Pythonì…ë‹ˆë‹¤. ë‹¤ìŒì€ marimoê°€ íŒŒì¼ í˜•ì‹ì—ì„œ Pythonì— SQLì„ í¬í•¨í•˜ëŠ” ë°©ë²•ì˜ ì˜ˆì…ë‹ˆë‹¤.

```python
output_df = mo.sql(f"SELECT * FROM my_table LIMIT {max_rows.value}")
```

ì…€ì— **`output_df`** ë³€ìˆ˜ê°€ ìˆìŒì„ í™•ì¸í•©ë‹ˆë‹¤. ì´ê²ƒì€ ê²°ê³¼ Polars DataFrame(`polars`ê°€ ì„¤ì¹˜ëœ ê²½ìš°) ë˜ëŠ” Pandas DataFrame(ì„¤ì¹˜ë˜ì§€ ì•Šì€ ê²½ìš°)ì…ë‹ˆë‹¤. SQL ê²°ê³¼ì™€ ìƒí˜¸ ì‘ìš©í•˜ë ¤ë©´ ë‘˜ ì¤‘ í•˜ë‚˜ê°€ ì„¤ì¹˜ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

SQL ë¬¸ ìì²´ëŠ” í˜•ì‹ì´ ì§€ì •ëœ ë¬¸ìì—´(f-ë¬¸ìì—´)ì´ë¯€ë¡œ UI ìš”ì†Œì˜ ê°’ê³¼ ê°™ì€ ìœ íš¨í•œ Python ì½”ë“œë¥¼ í¬í•¨í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¦‰, SQL ë¬¸ê³¼ ê²°ê³¼ê°€ ë°˜ì‘í˜•ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤! ğŸš€
<!---->
## SQLë¡œ ë°ì´í„°í”„ë ˆì„ ì¿¼ë¦¬í•˜ê¸°
<!---->
/// íŒ | "ë°ì´í„° ì†ŒìŠ¤ íŒ¨ë„"

    ì™¼ìª½ ë„êµ¬ ëª¨ìŒì—ì„œ ë°ì´í„°ë² ì´ìŠ¤ "ë°°ëŸ´" ì•„ì´ì½˜ì„ í´ë¦­í•˜ë©´ ë…¸íŠ¸ë¶ì—ì„œ ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆëŠ” ëª¨ë“  ë°ì´í„°í”„ë ˆì„ê³¼ ë©”ëª¨ë¦¬ ë‚´ í…Œì´ë¸”ì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
///
<!---->
SQL ì…€ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë‹¤ìŒ ì…€ì€ `df`ë¼ëŠ” ë°ì´í„°í”„ë ˆì„ì„ ìƒì„±í•©ë‹ˆë‹¤.

```python {.marimo hide_code="true"}
_SIZE = 1000


def _create_token_data(n_items=100):
    import random
    import string

    def generate_random_string(length):
        letters = string.ascii_lowercase
        result_str = "".join(random.choice(letters) for i in range(length))
        return result_str

    def generate_random_numbers(mean, std_dev, num_samples):
        return [int(random.gauss(mean, std_dev)) for _ in range(num_samples)]

    random_numbers = generate_random_numbers(50, 15, n_items)
    random_strings = sorted(
        list(set([generate_random_string(3) for _ in range(n_items)]))
    )

    return {
        "token": random_strings,
        "count": random_numbers[: len(random_strings)],
    }


_data = _create_token_data(_SIZE)

# polars ì‹œë„
if has_polars_installed:
    import polars as pl

    df = pl.DataFrame(_data)
# pandasë¡œ ëŒ€ì²´ (ì„¤ì¹˜ ì‹œë„ ì¤‘ì¼ ìˆ˜ ìˆìŒ)
else:
    import pandas as pd

    df = pd.DataFrame(_data)
```

ë‹¤ìŒìœ¼ë¡œ Python ë°ì´í„°í”„ë ˆì„ `df`ë¥¼ ì§ì ‘ ì°¸ì¡°í•˜ëŠ” SQL ì¿¼ë¦¬ë¥¼ ë§Œë“­ë‹ˆë‹¤.

```sql {.marimo}
-- ì´ SQL ì…€ì€ ì „ì—­ ë²”ìœ„ì˜ ê¸°ì¡´ ë°ì´í„°í”„ë ˆì„ì„ SQL ì¿¼ë¦¬ì˜ í…Œì´ë¸”ë¡œ ì°¸ì¡°í•  ìˆ˜ ìˆìœ¼ë¯€ë¡œ íŠ¹ë³„í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Pythonì„ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ ì…€ì—ì„œ ì •ì˜ëœ ì „ì—­ ë²”ìœ„ì˜ `df` ë°ì´í„°í”„ë ˆì„ì„ ì°¸ì¡°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

SELECT * FROM df;

-- ê¸°ë³¸ì ìœ¼ë¡œ ì¶œë ¥ ë³€ìˆ˜ëŠ” ë°‘ì¤„(`_df`)ë¡œ ì‹œì‘í•˜ì—¬ ì´ ì…€ì— ë¹„ê³µê°œë¡œ ë§Œë“­ë‹ˆë‹¤. ë‹¤ë¥¸ ì…€ì—ì„œ ì¿¼ë¦¬ ê²°ê³¼ì— ì•¡ì„¸ìŠ¤í•˜ë ¤ë©´ ì¶œë ¥ ë³€ìˆ˜ì˜ ì´ë¦„ì„ ë³€ê²½í•©ë‹ˆë‹¤.
```

## Pythonì—ì„œ SQLë¡œ, ë‹¤ì‹œ SQLì—ì„œ Pythonìœ¼ë¡œ
<!---->
UI ìš”ì†Œì™€ ê°™ì€ Python ê°’ì— ë”°ë¼ ë‹¬ë¼ì§€ëŠ” SQL ë¬¸ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python {.marimo hide_code="true"}
token_prefix = mo.ui.dropdown(
    list(string.ascii_lowercase), label="í† í° ì ‘ë‘ì‚¬", value="a"
)
token_prefix
```

```sql {.marimo query="result"}
-- SQL ì¿¼ë¦¬ í•„í„° ìì²´ë¥¼ ë³´ë ¤ë©´ ë“œë¡­ë‹¤ìš´ì„ ë³€ê²½í•©ë‹ˆë‹¤!
--
-- ì—¬ê¸°ì„œëŠ” `starts_with`ë¼ëŠ” duckdb í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.
SELECT * FROM df WHERE starts_with(token, '{token_prefix.value}')

-- ì¶œë ¥ ë³€ìˆ˜ì˜ ì´ë¦„ì„ `result`ë¡œ ì§€ì •í–ˆìŠµë‹ˆë‹¤.
```

ìœ„ì—ì„œ ì¶œë ¥ ë³€ìˆ˜ì˜ ì´ë¦„ì„ **`result`**ë¡œ ì§€ì •í–ˆìœ¼ë¯€ë¡œ
Pythonì—ì„œ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python {.marimo hide_code="true"}
charting_library = mo.ui.radio(["matplotlib", "altair", "plotly"])

mo.md(
    f"""
    ì„ íƒí•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ ê²°ê³¼ë¥¼ ì°¨íŠ¸ë¡œ ë§Œë“¤ì–´ ë³´ê² ìŠµë‹ˆë‹¤.

    {charting_library}
    """
)
```

```python {.marimo hide_code="true"}
_header = mo.md(
    f"""
    ìœ„ì˜ ë“œë¡­ë‹¤ìš´ì„ ë‹¤ì‹œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. {token_prefix}

    ì´ì œ SQL ì¿¼ë¦¬ ë° UI ìš”ì†Œë¡œ êµ¬ë™ë˜ëŠ” {token_prefix.value}ë¡œ ì‹œì‘í•˜ëŠ” í† í°ì˜ í† í° ìˆ˜ ë¶„í¬ë¥¼ ì‹œê°í™”í•˜ëŠ” íˆìŠ¤í† ê·¸ë¨ì´ ìˆìŠµë‹ˆë‹¤.
    """
)

render_chart(
    charting_library.value, _header
) if charting_library.value else None
```

```python {.marimo hide_code="true"}
def render_chart(charting_library, header):
    return mo.vstack(
        [header, render_charting_library(charting_library)]
    ).center()


def render_charting_library(charting_library):
    if charting_library == "matplotlib":
        return render_matplotlib()
    if charting_library == "altair":
        return render_altair()
    if charting_library == "plotly":
        return render_plotly()


def render_matplotlib():
    import matplotlib.pyplot as plt

    plt.hist(result["count"], label=token_prefix.value)
    plt.xlabel("í† í° ìˆ˜")
    plt.legend()
    plt.tight_layout()
    return plt.gcf()


def render_altair():
    import altair as alt

    chart = (
        alt.Chart(result)
        .mark_bar()
        .encode(x=alt.X("count", bin=True), y=alt.Y("count()"))
    )
    return mo.ui.altair_chart(chart, chart_selection=False)


def render_plotly():
    import plotly.graph_objects as go

    return go.Figure(data=[go.Histogram(x=result["count"])])
```

## CSV, Parquet, Postgres ë“± ...
<!---->
ë°ì´í„°í”„ë ˆì„ ì¿¼ë¦¬ì—ë§Œ êµ­í•œë˜ì§€ ì•ŠìŠµë‹ˆë‹¤. **HTTP URL, S3 ê²½ë¡œ ë˜ëŠ” ë¡œì»¬ csv ë˜ëŠ” parquet íŒŒì¼ì˜ íŒŒì¼ ê²½ë¡œ**ë„ ì¿¼ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```sql
-- ë˜ëŠ”
SELECT * FROM 's3://my-bucket/file.parquet';
-- ë˜ëŠ”
SELECT * FROM read_csv('path/to/example.csv');
-- ë˜ëŠ”
SELECT * FROM read_parquet('path/to/example.parquet');
```

ì•½ê°„ì˜ ìƒìš©êµ¬ë¥¼ ì‚¬ìš©í•˜ë©´ **Postgres**ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆìœ¼ë©° ë™ì¼í•œ ì¿¼ë¦¬ì—ì„œ Postgres í…Œì´ë¸”ì„ ë°ì´í„°í”„ë ˆì„ê³¼ ì¡°ì¸í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤. ì§€ì›ë˜ëŠ” ë°ì´í„° ì†ŒìŠ¤ì˜ ì „ì²´ ëª©ë¡ì€ [duckdb í™•ì¥](https://duckdb.org/docs/extensions/overview) ë° [duckdb ì—°ê²°ì— ëŒ€í•œ ì˜ˆì œ ë…¸íŠ¸ë¶](https://github.com/marimo-team/marimo/blob/main/examples/sql/duckdb_connections.**py**)ì„ í™•ì¸í•˜ì‹­ì‹œì˜¤.

ì´ ì˜ˆì—ì„œëŠ” csvì˜ HTTP ì—”ë“œí¬ì¸íŠ¸ë¥¼ ì¿¼ë¦¬í•©ë‹ˆë‹¤.

```sql {.marimo query="cars"}
-- CSVë¥¼ ë‹¤ìš´ë¡œë“œí•˜ê³  ë©”ëª¨ë¦¬ ë‚´ í…Œì´ë¸”ì„ ë§Œë“­ë‹ˆë‹¤. ì´ê²ƒì€ ì„ íƒ ì‚¬í•­ì…ë‹ˆë‹¤.
CREATE OR replace TABLE cars as
FROM 'https://datasets.marimo.app/cars.csv';

-- í…Œì´ë¸” ì¿¼ë¦¬
SELECT * from cars;
```

```python {.marimo hide_code="true"}
cylinders_dropdown = mo.ui.range_slider.from_series(
    cars["Cylinders"], debounce=True, show_value=True
)
origin_dropdown = mo.ui.dropdown.from_series(cars["Origin"], value="Asia")
mo.hstack([cylinders_dropdown, origin_dropdown]).left()
```

```sql {.marimo query="filtered_cars"}
SELECT * FROM cars
WHERE
    Cylinders >= {cylinders_dropdown.value[0]}
    AND
    Cylinders <= {cylinders_dropdown.value[1]}
    AND
    ORIGIN = '{origin_dropdown.value}'
```

```python {.marimo hide_code="true"}
mo.hstack(
    [
        mo.stat(label="ì´ ìë™ì°¨ ìˆ˜", value=str(len(filtered_cars))),
        mo.stat(
            label="í‰ê·  ê³ ì†ë„ë¡œ ì—°ë¹„",
            value=f"{filtered_cars['MPG_Highway'].mean() or 0:.1f}",
        ),
        mo.stat(
            label="í‰ê·  ì‹œë‚´ ì—°ë¹„",
            value=f"{filtered_cars['MPG_City'].mean() or 0:.1f}",
        ),
    ]
)
```

```python {.marimo hide_code="true"}
import marimo as mo
import random
```

```python {.marimo hide_code="true"}
import string
```